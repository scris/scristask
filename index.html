<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>
			Scris Task
		</title>
		<script src="js/jquery-3.3.1.min.js">
		</script>
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
		<script src="js/airtable.browser.js"></script>
		<script src="js/av-min.js"></script>
		<meta name="viewport" content="minimal-ui,width=device-width"/>	
 		<link rel="apple-touch-icon" href="task.png">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="white">
		<link rel="stylesheet" href="css/reset.min.css">
		<link rel="stylesheet prefetch" href="css/bootstrap.min.css">
		<link rel="stylesheet prefetch" href="css/animate.min.css">
		<link rel="stylesheet" href="css/quentin.css">
		<style>
			@font-face{
				font-family: 'vffree72';
				src: url('fonts/vffree72.svg'),
					 url('fonts/vffree72.woff');
			}

			body {
				background: #fff;
				font: 14px 'vffree72', sans-serif;
			}
			
			#starty, #pstart, #ppause
			{
			    cursor: pointer;
			}
		</style>
	</head>
	<body class="body">
	<script>
				$("#settings").hide();
				$("#taskmain").show();
				$("#btimer").hide();
				$("#ptimer").hide();
				$("#blankb").hide();
				$("#blankp").hide();
				$("#ppause").hide();
	</script>
		<div class="container">
			<div class="today">
			</div>
	
			<div class="row" id="taskmain">
				<div class="col-md-4 col-md-offset-4 col-xs-6 col-xs-offset-3">
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="text" class="form-control" placeholder="✍️ Add item..." />
							<i class="fa fa-plus form-control-feedback add-btn" title="Add item">
							</i>
						</div>
					</div>
					<p class="err text-danger text-center hidden">
						<i class="fa fa-warning">
						</i>
						Oops! Please enter name item.
					</p>
					<p class="no-items text-muted text-center hidden">
						<i class="fa fa-ban">
						</i>
					</p>
					<ul class="todo-list">
					</ul>
				</div>
			</div>
							
			<div class="container" id="blankp" style="display: none;"></div>
			
			<div class="row" id="ptimer" style="display: none;">
   
				<div class="col-md-4 col-md-offset-4 col-xs-6 col-xs-offset-3 pclock">
						<div id="pomotoro add-control">
							<span id="pminute">52</span>
							<span>:</span>
							<span id="psecond">00</span>
						</div>
						<br>
					<div id="psetting add-control">
						<div class="form-group has-feedback">
													<input type="text" placeholder="📒 The name of the project" id="proj" class="form-control"><br>
							<input type="text" placeholder="👨‍💻 Working Time/min" id="ptime" class="form-control"></div>
							<div class="form-group has-feedback">
						
							<input type="button" id="pstart" class="form-control sbtn" value="Start/Reset Countdown">	<br>
							<input type="button" id="ppause" class="form-control sbtn" value="Pause"></div>
						</div>
					</div>
				</div>
				
			<div class="container" id="blankb" style="display: none;"></div>
			
			<div class="row" id="btimer" style="display: none;">
				<div class="col-md-4 col-md-offset-4 col-xs-6 col-xs-offset-3 pclock">
					<div id="pomotoro add-control">
						<span id="minute">52</span>
						<span>:</span>
						<span id="second">00</span>
					</div>
					<br>
				<div id="setting add-control">
					<div class="form-group has-feedback">
						<input type="text" placeholder="💪 Working Time/min" id="worktime" class="form-control">
						<br>
						<input type="text" placeholder="🔌 Breaktime/min" id="breaktime" class="form-control">
					</div>
					<div class="form-group has-feedback">
						<input type="button" id="starty" class="form-control sbtn" value="Start/Reset Workbreak Timer">
					</div>
					</div>
				</div>
			</div>
				
			<div class="row" id="settings" style="display: none;">
				<div class="col-md-4 col-md-offset-4 col-xs-6 col-xs-offset-3">
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="username" class="form-control" id="in0" placeholder="📛 User Name" required autofocus/>
						</div>
					</div>
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="password" class="form-control" id="in1" placeholder="📮 Email Address" required/>
						</div>
					</div>
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="email" class="form-control" id="in2" placeholder="🤫 Your password" required/>
						</div>
					</div>
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="button" id="settingsbtn1" value="Log in" class="form-control sbtn">
						</div>
					</div>
					<div class="add-control">
						<div class="form-group has-feedback">
							<input type="button" id="settingsbtn2" value="Register" class="form-control sbtn">
						</div>
					</div>
				</div>
			</div>
		</div>
			
		<div class="footer">
			<h4>
				Copyright &copy; 2015-2018 Scris Game Studio.<br><br><br>
				Some CSS is from <a href="http://quentincolus.com/about.html">Quentin</a>.<br><br><br>
				Every task here will soon be vanished tomorrow, however you can edit the time <a href="how.html">here</a>.<br><br><br><br>
				<a id="settingstoggle">Airtable Sync Settings</a> | <a id="ptimertoggle">Project Timer</a> | <a id="btimertoggle">Work &amp; Break Timer</a>
				<br><br><br>
			</h4>
		</div>
		
	
		<audio id="finishsound">
<source	src="ding.mp3"/>
</audio>

	
		<script>
			//controller
			$("#settingstoggle").click(function(){
				$("#settings").show();
				$("#taskmain").hide();
				$("#btimer").hide();
				$("#ptimer").hide();
				$("#blankb").hide();
				$("#blankp").hide();
			});
			$("#btimertoggle").click(function(){
				$("#taskmain").show();
				$("#btimer").toggle();
				$("#settings").hide();
				$("#blankb").toggle();
			});
			$("#ptimertoggle").click(function(){
				$("#taskmain").show();
				$("#ptimer").toggle();
				$("#settings").hide();
				$("#blankp").toggle();
			});
			
			//lencloud-av
			var APP_ID = 'C7SVWNehvavYoUH5cssIKYDH-MdYXbMMI';
			var APP_KEY = 'nJ2QMhw8deT5QwNt40rjsaK7';
			AV.init({
				appId: APP_ID,
				appKey: APP_KEY,
				region: 'us'
			});

			//localstorage
			if(!window.localStorage){
				alert("LocalStorage is currently unsupported, please update your browser.");
			}else{
				var storage=window.localStorage;
				if(storage.getItem("scristaskapi") == null){
					alert("Seems that you haven't logged in. Click OK to log in.");
					setTimeout(function(){$("#settings").show();$("#taskmain").hide();},500);
				}
 			}
			$("#settingsbtn1").click(function(){
				var avuuser = $("#in0").val();
				var avuemail = $("#in1").val();  		 
				var avupwd = $("#in2").val();
				AV.User.logIn(avuuser, avupwd).then(function (loginedUser) {
					document.location.reload();
				}, function (error) {
					alert(JSON.stringify(error));
				});
			});
			function signup() {
			  var username = $('#in0').val();
			  var password = $('#in2').val();
			  var email = $('in1').val();

			  // LeanCloud - 注册
			  // https://leancloud.cn/docs/leanstorage_guide-js.html#注册
			  var user = new AV.User();
			  user.setUsername(username);
			  user.setPassword(password);
			  user.setEmail(email);
			  console.log(user);
			  user.signUp().then(function (loginedUser) {
				document.location.reload();
			  }, (function (error) {
				alert(JSON.stringify(error));
			  }));
			};
			$("settingsbtn2").click(function(e){
				e.preventDefault();
				signup();
			});
		</script>
		<script src="js/av-taskmain.js"></script>
		<script src="js/ptimer.js"></script>
		<script src="js/btimer.js"></script>
	</body>

</html>
